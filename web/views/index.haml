!!!5
%html
	%head
		%title rokk.in | Fund and Discover Great Music

		%link(href="http://fonts.googleapis.com/css?family=Play" rel="stylesheet" type="text/css")
		%link(href="/css/reset.css" rel="stylesheet" type="text/css")
		%link(href="/css/ionicons.min.css" rel="stylesheet" type="text/css")
		%link(href="/css/icomoon.css" rel="stylesheet" type="text/css")
		%link(href="/web/css/rokkin.min.css" rel="stylesheet" type="text/css")

		%script(src="http://connect.soundcloud.com/sdk.js")

		%script(src="/js/jquery-1.10.2.min.js" type="text/javascript")
		%script(src="/js/underscore-1.5.2.min.js" type="text/javascript")
		%script(src="/js/knockout-3.0.0.min.js" type="text/javascript")
		%script(src="/js/falcon.min.js" type="text/javascript")
		%script(src="/js/finch.min.js" type="text/javascript")

		:javascript
			Falcon.baseApiUrl = "/api";
			window.ENV = ENV = {
				"SOUNDCLOUD_CLIENT_ID": "43c5eb08ce4cad456b238c464be6543e",
				"SOUNDCLOUD_REDIRECT_URL": "#{soundcloud_redirect_url}"
			};

		%script(src="/web/js/rokkin.js" type="text/javascript")

%template#application-tmpl
	-ko("ifnot: $view.is_checking_session") do
		-ko("ifnot: $view.is_logged_in") do
			-ko("view: $view.splash_view")
		-ko("if: $view.is_logged_in") do
			#header
				.logo
					rokk
					.highlight<> .in
				%form.search-form<>
					%input(type="text" placeholder="Search...")
					%i.ion-search

				.pull-right
					.mini-profile(data-bind="with: $view.current_user")
						%img(data-bind="src: Helpers.resize_image(avatar_url, 'small')")
						-ko("text: full_name")

					.logout(title="Logout" data-bind="click: $view.logout")
						%i.ion-power

			#sidebar
				%ul.sidebar-menu
					%li.sidebar-menu-item(data-bind="css: {'selected': $view.is_dashboard_selected}, click: Router.gotoDashboard")
						%i.ion-compass
						Dashboard

					%li.sidebar-menu-item(data-bind="css: {'selected': $view.is_stream_selected}, click: Router.gotoStream")
						%i.ion-social-rss
						Stream

					%li.sidebar-menu-item
						%i.ion-person
						Profile

			#content(data-bind="view: $view.content_view")
%template#dashboard-tmpl	
	%ul
		%li New Users
		%li Top Funders
		%li Top Funded
		%li Your Top Donations
%template#splash-tmpl
	#splash
		.logo
			rokk
			.highlight<> .in
		.tagline
			Fund &amp; Discover Great Music
		.login-button(data-bind="click: $view.connect")
			%i.icon-soundcloud
			Sign In with SoundCloud
%template#stream-tmpl
	-ko("if: $view.is_loading") do
		.loader
	-ko("ifnot: $view.is_loading") do
		-ko("with: $view.current_user") do
			%ul.grid-list(data-bind="foreach: sc_user.activities")
				%li.grid-list-item.track(data-bind="with: track")<>
					.track-image
						%img(data-bind="src: Helpers.resize_image(artwork_url,'t300x300')")
						-ko("if: streamable") do
							.track-play-icon(data-bind="click: play")<>
								-ko("ifnot: is_playing") do
									%i.ion-ios7-play<>
								-ko("if: is_playing") do
									%i.ion-ios7-pause<>
					-ko("text: title")